{"swagger":"2.0","info":{"title":"MetadataRegistry API","description":"Documentation for the new API endpoints","version":"v1","contact":{"name":"Metadata Registry","email":"learningreg-dev@googlegroups.com","url":"https://github.com/learningtapestry/metadataregistry"},"license":{"name":"Apache License, Version 2.0","url":"http://www.apache.org/licenses/LICENSE-2.0"}},"host":"localhost:9292","consumes":["application/json"],"produces":["application/json"],"paths":{"/":{"get":{"operationId":"getApi","description":"Show the README rendered in HTML","produces":["text/html"],"responses":{"200":{"description":"shows the README rendered in HTML"}}}},"/api":{"get":{"operationId":"getApi","description":"API root","produces":["application/json"],"responses":{"200":{"description":"API root","schema":{"$ref":"#/definitions/ApiRoot"}}}}},"/api/info":{"get":{"operationId":"getApiInfo","description":"General info about this API node","produces":["application/json"],"responses":{"200":{"description":"General info about this API node","schema":{"$ref":"#/definitions/ApiInfo"}}}}},"/api/schemas/info":{"get":{"operationId":"getApiSchemasInfo","description":"General info about the json-schemas","produces":["application/json"],"responses":{"200":{"description":"General info about the json-schemas","schema":{"$ref":"#/definitions/SchemasInfo"}}}}},"/api/schemas/{schema_name}":{"get":{"operationId":"getApiSchema","description":"Get the corresponding json-schema","produces":["application/json"],"parameters":[{"name":"schema_name","in":"path","type":"string","required":true,"description":"Unique schema name"}],"responses":{"200":{"description":"Get the corresponding json-schema"}}}},"/api/{community_name}":{"get":{"operationId":"getApiCommunity","description":"Retrieve metadata community","produces":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"}],"responses":{"200":{"description":"Retrieve metadata community","schema":{"$ref":"#/definitions/Community"}}}}},"/api/{community_name}/info":{"get":{"operationId":"getApiCommunityInfo","description":"General info about this metadata community","produces":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"}],"responses":{"200":{"description":"General info about this metadata community","schema":{"$ref":"#/definitions/CommunityInfo"}}}}},"/api/{community_name}/envelopes":{"get":{"operationId":"getApiEnvelopes","description":"Retrieves all community envelopes ordered by date","produces":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"},{"name":"page","in":"query","type":"integer","format":"int32","default":1,"required":false,"description":"Page number"},{"name":"per_page","in":"query","type":"integer","format":"int32","default":10,"required":false,"description":"Items per page"},{"name":"include_deleted","in":"query","type":"string","required":false,"description":"Whether entries marked as deleted should be included (Accepts: \"true\" or \"only\")"}],"responses":{"200":{"description":"Retrieves all envelopes ordered by date","schema":{"type":"array","items":{"$ref":"#/definitions/Envelope"}}}}},"post":{"operationId":"postApiEnvelopes","description":"Publishes a new envelope","produces":["application/json"],"consumes":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"},{"name":"update_if_exists","in":"query","type":"boolean","required":false,"description":"Whether to update the envelope if exists"},{"name":"Envelope","in":"body","required":true,"schema":{"$ref":"RequestEnvelope"}}],"responses":{"200":{"description":"Envelope updated","schema":{"$ref":"#/definitions/Envelope"}},"201":{"description":"Envelope created","schema":{"$ref":"#/definitions/Envelope"}},"422":{"description":"Validation Error","schema":{"$ref":"#/definitions/ValidationError"}}}},"put":{"description":"Publishes a new envelope","operationId":"putApiEnvelopes","produces":["application/json"],"consumes":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"},{"name":"envelope_id","in":"body","type":"string","required":true,"description":"Unique envelope identifier"},{"name":"DeleteToken","in":"body","required":true,"schema":{"$ref":"DeleteToken"}}],"responses":{"204":{"description":"Mathcing envelopes marked as deleted"},"404":{"description":"No envelopes match the envelope_id"},"422":{"description":"Validation Error","schema":{"$ref":"#/definitions/ValidationError"}}}}},"/api/{community_name}/envelopes/info":{"get":{"operationId":"getApiEnvelopesInfo","description":"Gives general info about this community envelopes","produces":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"}],"responses":{"200":{"description":"Gives general info about this community envelopes","schema":{"$ref":"#/definitions/EnvelopesInfo"}}}}},"/api/{community_name}/envelopes/{envelope_id}":{"get":{"operationId":"getApiSingleEnvelope","description":"Retrieves an envelope by identifier","produces":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"},{"name":"envelope_id","in":"body","type":"string","required":true,"description":"Unique envelope identifier"},{"name":"include_deleted","in":"query","type":"string","required":false,"description":"Whether entries marked as deleted should be included (Accepts: \"true\" or \"only\")"}],"responses":{"200":{"description":"Retrieves an envelope by identifier","schema":{"$ref":"#/definitions/Envelope"}}}},"patch":{"operationId":"patchApiSingleEnvelope","description":"Updates an existing envelope","produces":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"},{"name":"envelope_id","in":"body","type":"string","required":true,"description":"Unique envelope identifier"},{"name":"Envelope","in":"body","required":true,"schema":{"$ref":"RequestEnvelope"}}],"responses":{"200":{"description":"Updates an existing envelope","schema":{"$ref":"#/definitions/Envelope"}},"422":{"description":"Validation Error","schema":{"$ref":"#/definitions/ValidationError"}}}},"delete":{"operationId":"deleteApiSingleEnvelope","description":"Marks an existing envelope as deleted","produces":["application/json"],"consumes":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"},{"name":"envelope_id","in":"body","type":"string","required":true,"description":"Unique envelope identifier"},{"name":"DeleteToken","in":"body","required":true,"schema":{"$ref":"DeleteToken"}}],"responses":{"204":{"description":"Marks an existing envelope as deleted"},"422":{"description":"Validation Error","schema":{"$ref":"#/definitions/ValidationError"}}}}},"/api/{community_name}/envelopes/{envelope_id}/info":{"get":{"operationId":"getApiSingleEnvelopeInfo","description":"Gives general info about the single envelope","produces":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"},{"name":"envelope_id","in":"body","type":"string","required":true,"description":"Unique envelope identifier"},{"name":"include_deleted","in":"query","type":"string","required":false,"description":"Whether entries marked as deleted should be included (Accepts: \"true\" or \"only\")"}],"responses":{"200":{"description":"General info about this metadata community","schema":{"$ref":"#/definitions/SingleEnvelopeInfo"}}}}},"/api/{community_name}/envelopes/{envelope_id}/versions/{version_id}":{"get":{"operationId":"getApiEnvelopeVersion","description":"Retrieves a specific envelope version","produces":["application/json"],"parameters":[{"name":"community_name","in":"path","type":"string","required":true,"description":"Unique community name"},{"name":"envelope_id","in":"body","type":"string","required":true,"description":"Unique envelope identifier"},{"name":"include_deleted","in":"query","type":"string","required":false,"description":"Whether entries marked as deleted should be included (Accepts: \"true\" or \"only\")"},{"name":"version_id","in":"path","type":"string","required":true,"description":"Unique version identifier"}],"responses":{"200":{"description":"Retrieves a specific envelope version","schema":{"$ref":"#/definitions/Envelope"}}}}}},"definitions":{"ApiRoot":{"properties":{"api_version":{"type":"string","description":"API version number"},"total_envelopes":{"type":"integer","format":"int32","description":"Total count of metadata envelopes"},"metadata_communities":{"type":"object","description":"Object with community names and their API urls"},"info":{"type":"string","description":"URL for the API info"}}},"ApiInfo":{"properties":{"metadata_communities":{"type":"object","description":"Object with community names and their API urls"},"postman":{"type":"string","description":"URL for the postman collection"},"swagger":{"type":"string","description":"URL for the Swagger docs"},"readme":{"type":"string","description":"URL for the repo's README doc"},"docs":{"type":"string","description":"URL for the docs folder"}}},"SchemasInfo":{"properties":{"available_schemas":{"type":"array","description":"List of json-schema URLs available","items":{"type":"string","description":"json-schema URL"}},"specification":{"type":"string","description":"URL for the json-schema spec"}}},"Community":{"properties":{"id":{"type":"integer","format":"int32","description":"Community id"},"name":{"type":"string","description":"Community name"},"backup_item":{"type":"string","description":"Backup item name on Internet Archive"},"default":{"type":"boolean","description":"Wether this is the default Community or not"},"created_at":{"type":"string","format":"date-time","description":"When the version was created"},"updated_at":{"type":"string","format":"date-time","description":"When the version was updated"}}},"CommunityInfo":{"properties":{"total_envelopes":{"type":"integer","format":"int32","description":"Total count of envelopes for this community"},"backup_item":{"type":"string","description":"Internet Archive backup item identifier"}}},"EnvelopesInfo":{"properties":{"POST":{"description":"Info for POST requests","properties":{"accepted_schemas":{"description":"List of accepted_schemas","type":"array","items":{"type":"string","description":"json-schema URL"}}}},"PUT":{"description":"Info for PUT requests","properties":{"accepted_schemas":{"description":"List of accepted_schemas","type":"array","items":{"type":"string","description":"json-schema URL"}}}}}},"SingleEnvelopeInfo":{"properties":{"PATCH":{"description":"Info for PATCH requests","properties":{"accepted_schemas":{"description":"List of accepted_schemas","type":"array","items":{"type":"string","description":"json-schema URL"}}}},"DELETE":{"description":"Info for DELETE requests","properties":{"accepted_schemas":{"description":"List of accepted_schemas","type":"array","items":{"type":"string","description":"json-schema URL"}}}}}},"Envelope":{"description":"Retrieves a specific envelope version","properties":{"envelope_id":{"type":"string","description":"Unique identifier (in UUID format)"},"envelope_type":{"type":"string","description":"Type (\"resource_data\" or \"paradata\")"},"envelope_version":{"type":"string","description":"Envelope version used"},"resource":{"type":"string","description":"Resource in its original encoded format"},"decoded_resource":{"type":"string","description":"Resource in decoded form"},"resource_format":{"type":"string","description":"Format of the submitted resource"},"resource_encoding":{"type":"string","description":"Encoding of the submitted resource"},"node_headers":{"description":"Additional headers added by the node","$ref":"#/definitions/NodeHeaders"}}},"NodeHeaders":{"properties":{"resource_digest":{"type":"string"},"versions":{"type":"array","items":{"$ref":"Version"},"description":"Versions belonging to the envelope"},"created_at":{"type":"string","format":"date-time","description":"Creation date"},"updated_at":{"type":"string","format":"date-time","description":"Last modification date"},"deleted_at":{"type":"string","format":"date-time","description":"Deletion date"}}},"Version":{"properties":{"head":{"type":"boolean","description":"Tells if it's the current version"},"event":{"type":"string","description":"What change caused the new version"},"created_at":{"type":"string","format":"date-time","description":"When the version was created"},"actor":{"type":"string","description":"Who performed the changes"},"url":{"type":"string","description":"Version URL"}}},"ValidationError":{"properties":{"errors":{"description":"List of validation error messages","type":"array","items":{"type":"string"}},"json_schema":{"description":"List of json-schema's used for validation","type":"array","items":{"type":"string","description":"json-schema URL"}}}},"DeleteToken":{"description":"Marks an envelope as deleted","properties":{"delete_token":{"type":"string","required":true,"description":"Any content signed with the user's private key"},"delete_token_format":{"type":"string","required":true,"description":"Format of the submitted delete token"},"delete_token_encoding":{"type":"string","required":true,"description":"Encoding of the submitted delete token"},"delete_token_public_key":{"type":"string","required":true,"description":"RSA key in PEM format (same pair used to encode)"}}},"RequestEnvelope":{"description":"Publishes a new envelope","properties":{"envelope_id":{"type":"string","description":"Unique identifier (in UUID format)"},"envelope_type":{"type":"string","required":true,"description":"Type (\"resource_data\" or \"paradata\")"},"envelope_version":{"type":"string","required":true,"description":"Envelope version used"},"resource":{"type":"string","required":true,"description":"Resource in its original encoded format"},"resource_format":{"type":"string","required":true,"description":"Format of the submitted resource"},"resource_encoding":{"type":"string","description":"Encoding of the submitted resource"},"resource_public_key":{"type":"string","required":true,"description":"RSA key in PEM format (same pair used to encode)"}}}}}